<div class="page-container">
  <div class="page-header">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-12">
          <h1 class="display-4 mb-3">
            <i class="bi bi-briefcase-fill me-3"></i>
            Mes Postulations
          </h1>
          <p class="lead mb-0">Consultez l'état de vos candidatures</p>
        </div>
      </div>
    </div>
  </div>

  <div class="container-modern">
    <!-- Statistiques -->
    <div class="content-card section-spacing" *ngIf="!loading && postulations.length > 0">
      <div class="content-card-body">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value">{{ getStats().total }}</div>
            <div class="stat-label">Total</div>
          </div>
          <div class="stat-item stat-warning">
            <div class="stat-value">{{ getStats().enAttente }}</div>
            <div class="stat-label">En attente</div>
          </div>
          <div class="stat-item stat-success">
            <div class="stat-value">{{ getStats().acceptee }}</div>
            <div class="stat-label">Acceptées</div>
          </div>
          <div class="stat-item stat-danger">
            <div class="stat-value">{{ getStats().refusee }}</div>
            <div class="stat-label">Refusées</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filtres -->
    <div class="content-card section-spacing">
      <div class="content-card-body">
        <div class="d-flex gap-3 align-items-center flex-wrap">
          <label class="form-label mb-0">Filtrer par statut:</label>
          <select class="form-select" style="max-width: 250px;" [(ngModel)]="selectedStatut" (change)="onStatutChange()">
            <option value="">Tous les statuts</option>
            <option value="EN_ATTENTE">En attente</option>
            <option value="ACCEPTEE">Acceptée</option>
            <option value="REFUSEE">Refusée</option>
            <option value="EN_COURS">En cours</option>
            <option value="TERMINEE">Terminée</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Message de chargement -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <p class="mt-3 text-muted">Chargement de vos postulations...</p>
    </div>

    <!-- Message d'erreur -->
    <div *ngIf="errorMessage && !loading" class="alert alert-danger">
      <i class="bi bi-exclamation-triangle me-2"></i>{{ errorMessage }}
    </div>

    <!-- Message aucune postulation -->
    <div *ngIf="!loading && !errorMessage && postulations.length === 0" class="text-center py-5">
      <i class="bi bi-inbox fs-1 text-muted"></i>
      <p class="mt-3 text-muted">Aucune postulation trouvée</p>
      <a routerLink="/emplois" class="btn btn-primary">
        <i class="bi bi-search me-2"></i>Parcourir les offres
      </a>
    </div>

    <!-- Liste des postulations -->
    <div class="postulations-list" *ngIf="!loading && !errorMessage && postulations.length > 0">
      <div class="postulation-card" *ngFor="let postulation of postulations">
        <div class="postulation-header">
          <div class="postulation-main">
            <h5 class="postulation-title">{{ postulation.titreOffre }}</h5>
            <p class="postulation-nom text-muted">{{ postulation.nom }}</p>
            <div class="postulation-meta">
              <span class="meta-item">
                <i class="bi bi-calendar me-1"></i>{{ getDaysAgo(postulation.date) }}
              </span>
              <span class="meta-item">
                <i class="bi bi-clock me-1"></i>{{ formatDate(postulation.date) }}
              </span>
            </div>
          </div>
          <div class="postulation-status">
            <span class="badge" [ngClass]="getStatutBadgeClass(postulation.statut)">
              {{ getStatutLabel(postulation.statut) }}
            </span>
          </div>
        </div>

        <div class="postulation-body">
          <div class="postulation-message" *ngIf="postulation.message">
            <strong><i class="bi bi-chat-left-text me-1"></i>Message:</strong>
            <p class="mb-0">{{ postulation.message }}</p>
          </div>
        </div>

        <div class="postulation-footer">
          <small class="text-muted">
            <i class="bi bi-hash me-1"></i>ID: {{ postulation.trackingId }}
          </small>
        </div>
      </div>
    </div>
  </div>
</div>






